<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <Product Id="*" Name="YoloMouse" Language="1033" Version="0.2.0.0" Manufacturer="HaPpY" UpgradeCode="69ce184e-a676-4169-a124-e1ee073bd0e6">

    <Package Id="*" InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
    <MediaTemplate EmbedCab="yes" />

    <Feature Id="ProductFeature" Title="YoloMouse" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentGroupRef Id="CursorSmallComponents" />
      <ComponentGroupRef Id="CursorMediumComponents" />
      <ComponentGroupRef Id="CursorLargeComponents" />
      <ComponentGroupRef Id="SaveComponents" />
      <ComponentRef Id="ApplicationShortcut" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="ProgramFilesFolder">
        <Directory Id="APPLICATIONROOTDIRECTORY" Name="YoloMouse">
          <Directory Id="CURSORDIR" Name="Cursors">
            <Directory Id="CURSORSMALLDIR"  Name="Small" />
            <Directory Id="CURSORMEDIUMDIR" Name="Medium" />
            <Directory Id="CURSORLARGEDIR"  Name="Large" />
          </Directory>
        <Directory Id="SAVEDIR" Name="Save"/>
        </Directory>
        <Directory Id="ProgramMenuFolder">
          <Directory Id="ApplicationProgramsFolder" Name="YoloMouse"/>
        </Directory>
      </Directory>
    </Directory>

    <ComponentGroup Id="ProductComponents" Directory="APPLICATIONROOTDIRECTORY">
      <Component Guid="{B77158E0-4FC0-4323-975B-D3C3766D081E}">
        <File Id="YoloMouseExe" Source="$(var.YoloMouse.Loader.TargetPath)" KeyPath="yes" Checksum="yes"/>
      </Component>
      <Component Guid="{196DF733-044D-43D2-A79C-E230B10633F1}">
        <File Source="$(var.YoloMouse.Dll32.TargetPath)" KeyPath="yes" Checksum="yes" />
      </Component>
      <Component Id="SettingsIni" Guid="{445DA01E-1460-4A6D-A9D1-E2B07F503AD3}">
        <RemoveFile Id="SettingsIni" On="uninstall" Name="Settings.ini" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="CursorSmallComponents" Directory="CURSORSMALLDIR">
      <Component Id="SmallCursor1" Guid="{95E83A97-FB20-417A-B1DB-46C2A8336189}">
        <File Id="SmallCursor1" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\1.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor2" Guid="{1E242DD7-8DBE-4F06-8336-6DB6F3900749}">
        <File Id="SmallCursor2" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\2.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor3" Guid="{8E965DC8-A409-4214-9F40-1F7B0A5DF0FD}">
        <File Id="SmallCursor3" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\3.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor4" Guid="{940113DE-7783-4D08-A8FB-3A62FCF3E92E}">
        <File Id="SmallCursor4" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\4.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor5" Guid="{C21901C9-4454-47D7-BF98-0566CCB97AB7}">
        <File Id="SmallCursor5" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\5.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor6" Guid="{5D8CF04F-946C-4BB7-885C-3072167920F2}">
        <File Id="SmallCursor6" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\6.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor7" Guid="{D071CC02-9C04-426E-BD5D-A60C08D25812}">
        <File Id="SmallCursor7" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\7.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor8" Guid="{C59A4D79-5C51-4E0C-9A58-0627A05AA6E1}">
        <File Id="SmallCursor8" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\8.cur" KeyPath="yes" />
      </Component>
      <Component Id="SmallCursor9" Guid="{A2145AD1-E3EF-4BEE-B906-2C18FAC536B8}">
        <File Id="SmallCursor9" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Small\9.cur" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="CursorMediumComponents" Directory="CURSORMEDIUMDIR">
      <Component Id="MediumCursor1" Guid="{29D3A490-F781-4094-A669-69B07C0620F8}">
        <File Id="MediumCursor1" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\1.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor2" Guid="{347F3152-ED06-4EAF-9EEB-40B92AD3E5D9}">
        <File Id="MediumCursor2" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\2.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor3" Guid="{A271E3F7-CCCC-457E-BA6E-DD5091D05BCF}">
        <File Id="MediumCursor3" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\3.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor4" Guid="{90D3C190-B44A-4FA1-B240-939BA7A5C666}">
        <File Id="MediumCursor4" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\4.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor5" Guid="{1D6A501E-17F9-495C-8FAA-203238AD9CC7}">
        <File Id="MediumCursor5" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\5.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor6" Guid="{720BEEAA-C389-4743-8C8D-F7A3A03DA2B3}">
        <File Id="MediumCursor6" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\6.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor7" Guid="{266AA8C7-B535-4689-952B-5708091218DE}">
        <File Id="MediumCursor7" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\7.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor8" Guid="{FE56E4D1-2024-4766-91FD-6FBB78F1A22F}">
        <File Id="MediumCursor8" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\8.cur" KeyPath="yes" />
      </Component>
      <Component Id="MediumCursor9" Guid="{518D1733-E3C5-4FDB-8907-207555203179}">
        <File Id="MediumCursor9" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Medium\9.cur" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="CursorLargeComponents" Directory="CURSORLARGEDIR">
      <Component Id="LargeCursor1" Guid="{C845792E-1C41-4B31-8E45-6D921A9A9B64}">
        <File Id="LargeCursor1" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\1.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor2" Guid="{14D80564-CA7E-4C0A-A594-8D157781F69C}">
        <File Id="LargeCursor2" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\2.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor3" Guid="{D035139B-689C-47B7-A803-EE8B1EB63951}">
        <File Id="LargeCursor3" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\3.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor4" Guid="{1FDE2583-7326-43D9-AFB8-BD793761CA26}">
        <File Id="LargeCursor4" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\4.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor5" Guid="{87C6C06F-5D58-4E7B-BB12-8AFACC4F278C}">
        <File Id="LargeCursor5" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\5.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor6" Guid="{0B319B5D-8F1B-400A-9F01-8A576B74D4B2}">
        <File Id="LargeCursor6" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\6.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor7" Guid="{AD43910F-FE7E-4D09-95EF-79E5B5E05F03}">
        <File Id="LargeCursor7" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\7.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor8" Guid="{F33C061F-D9CC-40E2-9062-E3D99EEF23ED}">
        <File Id="LargeCursor8" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\8.cur" KeyPath="yes" />
      </Component>
      <Component Id="LargeCursor9" Guid="{A73A5907-5CC6-4F4C-9727-2D5F4694B0DE}">
        <File Id="LargeCursor9" Source="$(var.YoloMouse.Loader.TargetDir)\Cursors\Large\9.cur" KeyPath="yes" />
      </Component>
    </ComponentGroup>

    <ComponentGroup Id="SaveComponents" Directory="SAVEDIR">
      <Component Id="SaveFiles" Guid="{CC9204DD-6B03-4D65-9D84-162236F32186}" KeyPath="yes">
        <RemoveFile Id="SaveFiles" On="uninstall" Name="*.*" />
      </Component>
    </ComponentGroup>

    <DirectoryRef Id="ApplicationProgramsFolder">
      <Component Id="ApplicationShortcut" Guid="{00797B6E-D869-4803-99DE-A050B383653E}">
        <Shortcut Id="ApplicationStartMenuShortcut"
          Name="YoloMouse"
          Description="Shine those dull game cursors"
          Target="[#YoloMouseExe]"
          WorkingDirectory="APPLICATIONROOTDIRECTORY"/>
        <RemoveFolder Id="ApplicationProgramsFolder" On="uninstall"/>
        <RegistryValue Root="HKCU" Key="Software\Microsoft\YoloMouse" Name="installed" Type="integer" Value="1" KeyPath="yes"/>
      </Component>
    </DirectoryRef>

    <Property Id="WIXUI_INSTALLDIR" Value="APPLICATIONROOTDIRECTORY" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch YoloMouse" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOX" Value="1" />
    <Property Id="WixShellExecTarget" Value="[#YoloMouseExe]" />
    <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />

    <UI>
      <UIRef Id="WixUI_InstallDir"/>
      <DialogRef Id="FilesInUse" />
      <DialogRef Id="MsiRMFilesInUse" />
      <Publish Dialog="ExitDialog" Control="Finish" Event="DoAction" Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
    </UI>

  </Product>
</Wix>